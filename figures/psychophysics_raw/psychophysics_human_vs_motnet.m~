%% Load the human data

% done by hand in figs
mycolor=[.8 1 .62;.91 .80 .56;1 0.6 0.6; .62 .50 .91];


%% Load motnet data
r_coh = {}; p_coh = {}; r_con = {}; p_con = {};
r_coh{4} = [2.500000000000000000e-01 2.999999999999999889e-01 3.499999999999999778e-01 4.000000000000000222e-01 4.500000000000000111e-01 5.000000000000000000e-01 5.500000000000000444e-01 5.999999999999999778e-01 6.500000000000000222e-01 6.999999999999999556e-01 7.500000000000000000e-01 8.000000000000000444e-01 8.499999999999999778e-01 9.000000000000000222e-01 9.499999999999999556e-01 1.000000000000000000e+00];
p_coh{4} = [4.625000000000000222e-01 5.374999999999999778e-01 5.062499999999999778e-01 5.625000000000000000e-01 5.999999999999999778e-01 6.312499999999999778e-01 6.687499999999999556e-01 6.500000000000000222e-01 6.312499999999999778e-01 7.062500000000000444e-01 7.437500000000000222e-01 7.500000000000000000e-01 7.812500000000000000e-01 8.000000000000000444e-01 8.375000000000000222e-01 8.375000000000000222e-01];
r_coh{1} = [2.399999999999999911e-01 2.799999999999999711e-01 3.199999999999999512e-01 3.599999999999999312e-01 3.999999999999999112e-01 4.399999999999998912e-01 4.799999999999998712e-01 5.199999999999997957e-01 5.599999999999998312e-01 5.999999999999998668e-01 6.399999999999997913e-01 6.799999999999997158e-01 7.199999999999997513e-01 7.599999999999997868e-01 7.999999999999997113e-01 8.399999999999996358e-01 8.799999999999996714e-01 9.199999999999997069e-01 9.599999999999996314e-01 9.999999999999995559e-01];
p_coh{1} = [4.874999999999999889e-01 5.749999999999999556e-01 5.000000000000000000e-01 4.749999999999999778e-01 5.000000000000000000e-01 4.937500000000000222e-01 4.874999999999999889e-01 5.124999999999999556e-01 4.874999999999999889e-01 5.250000000000000222e-01 5.312500000000000000e-01 4.625000000000000222e-01 5.187500000000000444e-01 5.374999999999999778e-01 6.125000000000000444e-01 5.562500000000000222e-01 5.187500000000000444e-01 5.875000000000000222e-01 6.062499999999999556e-01 5.687499999999999778e-01];
r_coh{2} = [2.399999999999999911e-01 2.799999999999999711e-01 3.199999999999999512e-01 3.599999999999999312e-01 3.999999999999999112e-01 4.399999999999998912e-01 4.799999999999998712e-01 5.199999999999997957e-01 5.599999999999998312e-01 5.999999999999998668e-01 6.399999999999997913e-01 6.799999999999997158e-01 7.199999999999997513e-01 7.599999999999997868e-01 7.999999999999997113e-01 8.399999999999996358e-01 8.799999999999996714e-01 9.199999999999997069e-01 9.599999999999996314e-01 9.999999999999995559e-01];
p_coh{2} = [5.062499999999999778e-01 5.250000000000000222e-01 4.937500000000000222e-01 4.625000000000000222e-01 5.312500000000000000e-01 4.874999999999999889e-01 5.500000000000000444e-01 5.312500000000000000e-01 4.124999999999999778e-01 5.562500000000000222e-01 5.937500000000000000e-01 5.562500000000000222e-01 5.374999999999999778e-01 4.562499999999999889e-01 4.375000000000000000e-01 5.562500000000000222e-01 5.625000000000000000e-01 5.000000000000000000e-01 4.625000000000000222e-01 6.062499999999999556e-01];
r_coh{3} = [2.399999999999999911e-01 2.799999999999999711e-01 3.199999999999999512e-01 3.599999999999999312e-01 3.999999999999999112e-01 4.399999999999998912e-01 4.799999999999998712e-01 5.199999999999997957e-01 5.599999999999998312e-01 5.999999999999998668e-01 6.399999999999997913e-01 6.799999999999997158e-01 7.199999999999997513e-01 7.599999999999997868e-01 7.999999999999997113e-01 8.399999999999996358e-01 8.799999999999996714e-01 9.199999999999997069e-01 9.599999999999996314e-01 9.999999999999995559e-01];
p_coh{3} = [4.062500000000000000e-01 4.500000000000000111e-01 5.000000000000000000e-01 4.687500000000000000e-01 5.187500000000000444e-01 5.000000000000000000e-01 4.812500000000000111e-01 5.062499999999999778e-01 5.562500000000000222e-01 5.000000000000000000e-01 5.500000000000000444e-01 5.124999999999999556e-01 6.062499999999999556e-01 5.500000000000000444e-01 5.187500000000000444e-01 5.687499999999999778e-01 5.062499999999999778e-01 5.500000000000000444e-01 5.937500000000000000e-01 6.125000000000000444e-01];

r_con{4} = [6.099999999999999867e-01 6.199999999999999956e-01 6.300000000000000044e-01 6.400000000000000133e-01 6.500000000000000222e-01 6.600000000000000311e-01 6.700000000000000400e-01 6.800000000000000488e-01 6.900000000000000577e-01 7.000000000000000666e-01 7.100000000000000755e-01 7.200000000000000844e-01 7.300000000000000933e-01 7.400000000000001021e-01 7.500000000000001110e-01 7.600000000000001199e-01 7.700000000000001288e-01 7.800000000000001377e-01 7.900000000000001465e-01 8.000000000000001554e-01];
p_con{4} = [5.000000000000000000e-01 5.625000000000000000e-01 6.250000000000000000e-01 6.374999999999999556e-01 7.125000000000000222e-01 7.249999999999999778e-01 7.187500000000000000e-01 7.249999999999999778e-01 7.437500000000000222e-01 8.312500000000000444e-01 7.874999999999999778e-01 8.437500000000000000e-01 8.625000000000000444e-01 8.437500000000000000e-01 9.000000000000000222e-01 9.124999999999999778e-01 9.062500000000000000e-01 9.562500000000000444e-01 9.437499999999999778e-01 9.312500000000000222e-01];
r_con{1} = [6.099999999999999867e-01 6.199999999999999956e-01 6.300000000000000044e-01 6.400000000000000133e-01 6.500000000000000222e-01 6.600000000000000311e-01 6.700000000000000400e-01 6.800000000000000488e-01 6.900000000000000577e-01 7.000000000000000666e-01 7.100000000000000755e-01 7.200000000000000844e-01 7.300000000000000933e-01 7.400000000000001021e-01 7.500000000000001110e-01 7.600000000000001199e-01 7.700000000000001288e-01 7.800000000000001377e-01 7.900000000000001465e-01 8.000000000000001554e-01];
p_con{1} = [6.250000000000000000e-01 7.187500000000000000e-01 8.125000000000000000e-01 9.312500000000000222e-01 9.375000000000000000e-01 9.687500000000000000e-01 9.749999999999999778e-01 1.000000000000000000e+00 1.000000000000000000e+00 9.875000000000000444e-01 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00];
r_con{2} = [6.099999999999999867e-01 6.199999999999999956e-01 6.300000000000000044e-01 6.400000000000000133e-01 6.500000000000000222e-01 6.600000000000000311e-01 6.700000000000000400e-01 6.800000000000000488e-01 6.900000000000000577e-01 7.000000000000000666e-01 7.100000000000000755e-01 7.200000000000000844e-01 7.300000000000000933e-01 7.400000000000001021e-01 7.500000000000001110e-01 7.600000000000001199e-01 7.700000000000001288e-01 7.800000000000001377e-01 7.900000000000001465e-01 8.000000000000001554e-01];
p_con{2} = [5.625000000000000000e-01 6.250000000000000000e-01 6.750000000000000444e-01 6.187500000000000222e-01 6.999999999999999556e-01 6.812500000000000222e-01 8.187499999999999778e-01 7.500000000000000000e-01 8.062500000000000222e-01 8.874999999999999556e-01 8.437500000000000000e-01 8.625000000000000444e-01 9.062500000000000000e-01 9.437499999999999778e-01 9.062500000000000000e-01 9.499999999999999556e-01 9.749999999999999778e-01 9.749999999999999778e-01 9.687500000000000000e-01 9.687500000000000000e-01];
r_con{3} = [6.099999999999999867e-01 6.199999999999999956e-01 6.300000000000000044e-01 6.400000000000000133e-01 6.500000000000000222e-01 6.600000000000000311e-01 6.700000000000000400e-01 6.800000000000000488e-01 6.900000000000000577e-01 7.000000000000000666e-01 7.100000000000000755e-01 7.200000000000000844e-01 7.300000000000000933e-01 7.400000000000001021e-01 7.500000000000001110e-01 7.600000000000001199e-01 7.700000000000001288e-01 7.800000000000001377e-01 7.900000000000001465e-01 8.000000000000001554e-01];
p_con{3} = [4.812500000000000111e-01 5.749999999999999556e-01 6.250000000000000000e-01 6.562500000000000000e-01 6.999999999999999556e-01 6.812500000000000222e-01 8.062500000000000222e-01 7.750000000000000222e-01 8.000000000000000444e-01 8.437500000000000000e-01 7.937499999999999556e-01 8.375000000000000222e-01 8.625000000000000444e-01 8.937500000000000444e-01 9.312500000000000222e-01 9.187499999999999556e-01 9.437499999999999778e-01 9.562500000000000444e-01 9.562500000000000444e-01 9.562500000000000444e-01];

%% Contrast Plot

figure, hold on

for i = 1:3
    fit = fits{i}{2}.fit; % get contrast for this subject
    plot(fit.x,fit.y,'-','Color',[0 0 0],'LineWidth',3);
end

for i = 1:4
    fit = fitweibull(r_con{i}-.6,round(p_con{i}*100),'ntotal',100*ones(1,length(p_con{i})));
%     plot(fit.x,fit.y,'*','Color',mycolor(i,:));
    plot(fit.x,fit.y,'Color',mycolor(i,:),'LineWidth',3);
end
hline(0.5);
axis([0 .25 .5 1])
legend({'Human1','Human2','Human3','LGN','V1s','V1c','MT'});
title('Human and Neural Net Contrast Discrimination');
xlabel('Contrast Difference (%)');
ylabel('Performance (% Correct)');

%% Coherence Plot

figure, hold on

for i = 1:3
    fit = fits{i}{1}.fit; % get contrast for this subject
    plot(fit.x,fit.y,'-','Color',[0 0 0],'LineWidth',3);
end

for i = 1:4
    fit = fitweibull(r_coh{i}-.2,round(p_coh{i}*100),'ntotal',100*ones(1,length(p_coh{i})));
%     plot(fit.x,fit.y,'*','Color',mycolor(i,:));
    plot(fit.x,fit.y,'Color',mycolor(i,:),'LineWidth',3);
end
hline(0.5);
axis([0 .8 .5 1])
legend({'Human1','Human2','Human3','LGN','V1s','V1c','MT'});
title('Human and Neural Net Motion Coherence Discrimination');
xlabel('Coherence (% of Dots Moving)');
ylabel('Performance (% Correct)');


%% Generate an empty plot

figure
axis([0 1 0 1])
drawPublishAxis